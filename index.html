<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HovaLett ‚Äì Elveszett √©s tal√°lt t√°rgyak</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>
  <header class="page-header">
    <h1>HovaLett</h1>
    <p>Jelentsd be, ha tal√°lt√°l vagy elvesztett√©l valamit!</p>
    <div class="button-row">
      <button id="foundBtn">Tal√°ltam valamit</button>
      <button id="lostBtn">Elvesztettem valamit</button>
    </div>

    <div id="topMenu">
      <button id="myReportsBtn" class="menu-btn">Jelent√©seim</button>
      <button id="myMessagesBtn" class="menu-btn">√úzeneteim</button>
      <button id="menuLoginBtn" class="menu-btn">Bejelentkez√©s</button>
      <button id="homeBtn" class="menu-btn hidden">F≈ëoldal</button>
      <button id="logoutBtn" class="menu-btn hidden">Kijelentkez√©s</button>
      <span id="loggedUser" class="logged-user hidden">Bejelentkezve: Felhaszn√°l√≥</span>
    </div>
    <small id="supabaseStatus"></small>
  </header>

  <div class="main-container">
    <div id="leftPanel">
      <h2>Sz≈±r√©s</h2>
      <div class="filter-group">
        <button id="filterTalaltam" class="filter-btn green active">Tal√°ltam</button>
        <button id="filterKeresem" class="filter-btn red active">Keresem</button>
      </div>
      <div class="filter-categories">
        <button class="filter-cat active" data-cat="Telefon -√©s Kieg√©sz√≠t≈ëk">Telefon -√©s Kieg√©sz√≠t≈ëk</button>
        <button class="filter-cat active" data-cat="P√©nz, P√©nzt√°rca">P√©nz, P√©nzt√°rca</button>
        <button class="filter-cat active" data-cat="Okm√°nyok">Okm√°nyok</button>
        <button class="filter-cat active" data-cat="Ruh√°zat, t√°ska">Ruh√°zat, t√°ska</button>
        <button class="filter-cat active" data-cat="Kulcs">Kulcs</button>
        <button class="filter-cat active" data-cat="H√°zi√°llat">H√°zi√°llat</button>
        <button class="filter-cat active" data-cat="√âkszer">√âkszer</button>
        <button class="filter-cat active" data-cat="Egy√©b">Egy√©b</button>
      </div>
    </div>

    <div id="map"></div>

    <div id="rightPanel">
      <h2 id="reportPanelTitle">Legfrissebb jelent√©sek</h2>
      <div id="reportItems" class="report-list"></div>
    </div>
  </div>

  <div id="profileView" class="hidden">
    <div class="profile-user"><strong>Felhaszn√°l√≥:</strong> <span id="profileUserInfo"></span></div>
    <div class="profile-columns">
      <div>
        <h3>Saj√°t bejelent√©sek</h3>
        <div id="myReportsList" class="report-list"></div>
      </div>
      <div>
        <h3>√úzenetek (bej√∂v≈ë / kimen≈ë)</h3>
        <div id="messageList" class="report-list"></div>
      </div>
    </div>
  </div>

  <div id="bejelentesBox" class="hidden">
    <div id="markerForm" class="hidden">
      <button type="button" id="markerFormCloseBtn" class="modal-close-btn" data-flow-close="true" aria-label="Bez√°r√°s">‚úï</button>
      <h3>R√©szletek megad√°sa</h3>
      <label for="photoInput">K√©p felt√∂lt√©se</label>
      <input type="file" id="photoInput" accept="image/*" /><br><br>
      <label for="descriptionInput">Le√≠r√°s</label>
      <textarea id="descriptionInput" rows="4" cols="40" maxlength="500" placeholder="Le√≠r√°s... (max. 500 karakter)"></textarea><br><br>
      <label for="contactInput">El√©rhet≈ës√©g (opcion√°lis)</label>
      <input type="text" id="contactInput" placeholder="El√©rhet≈ës√©g (opcion√°lis)" /><br><br>
      <div id="j√°ratBox" class="hidden">
        <label for="routeInput">J√°ratsz√°m</label>
        <input type="text" id="routeInput" placeholder="J√°ratsz√°m (pl. 7-es busz)" /><br><br>
      </div>
      <div class="modal-actions">
        <button class="modal-secondary-btn back-btn" type="button">Vissza</button>
        <button id="saveBtn" class="modal-primary-btn" type="button">Ment√©s</button>
      </div>
    </div>
  </div>

  <div id="modal" class="modal hidden">
    <div class="modal-content"></div>
  </div>

  <div id="valasztoModal" class="modal hidden">
    <div class="modal-content">
      <button type="button" class="modal-close-btn" data-flow-close="true" aria-label="Bez√°r√°s">‚úï</button>
      <h3>Hol tal√°ltad vagy hol vesztetted el?</h3>
      <div class="valaszto-buttons">
        <button id="modalUtcaBtn" class="modal-primary-btn">üìç Utc√°n/√âp√ºletben</button>
        <button id="modalJarmuBtn" class="modal-primary-btn">üöç J√°rm≈±v√∂n</button>
      </div>
      <div class="modal-actions single-action">
        <button id="valasztoBackBtn" class="modal-secondary-btn">Vissza</button>
      </div>
    </div>
  </div>

  <div id="helyModal" class="modal hidden">
    <div class="modal-content">
      <button type="button" class="modal-close-btn" data-flow-close="true" aria-label="Bez√°r√°s">‚úï</button>
      <p>K√©rlek, t≈±zd le a t√©rk√©pen a pontos helyet.</p>
      <div class="modal-actions">
        <button id="helyBackBtn" class="modal-secondary-btn">Vissza</button>
        <button id="helyModalOkBtn" class="modal-primary-btn">OK</button>
      </div>
    </div>
  </div>

  <div id="datumModal" class="modal hidden">
    <div class="modal-content">
      <button type="button" class="modal-close-btn" data-flow-close="true" aria-label="Bez√°r√°s">‚úï</button>
      <h3>Mikor tal√°ltad vagy mikor vesztetted el?</h3>
      <div class="date-time-row">
        <div>
          <label for="reportDateInput">D√°tum</label>
          <input type="date" id="reportDateInput">
        </div>
        <div>
          <label for="reportTimeInput">Id≈ë</label>
          <input type="time" id="reportTimeInput" step="60">
        </div>
      </div>
      <p class="day-label">Nap: <strong id="dayOfWeek"></strong></p>
      <div class="modal-actions">
        <button id="datumBackBtn" class="modal-secondary-btn">Vissza</button>
        <button id="datumModalOkBtn" class="modal-primary-btn">OK</button>
      </div>
    </div>
  </div>

  <div id="kategoriavalasztoModal" class="modal hidden">
    <div class="modal-content">
      <button type="button" class="modal-close-btn" data-flow-close="true" aria-label="Bez√°r√°s">‚úï</button>
      <h3>Milyen t√≠pus√∫ t√°rgyr√≥l van sz√≥?</h3>
      <div class="kat-grid">
        <button class="kat-valaszto-btn">Telefon</button>
        <button class="kat-valaszto-btn">P√©nzt√°rca</button>
        <button class="kat-valaszto-btn">Okm√°ny</button>
        <button class="kat-valaszto-btn">Kulcs</button>
        <button class="kat-valaszto-btn">Ruh√°zat</button>
        <button class="kat-valaszto-btn">H√°zi√°llat</button>
        <button class="kat-valaszto-btn">√âkszer</button>
        <button class="kat-valaszto-btn">Egy√©b</button>
      </div>
      <div class="modal-actions single-action">
        <button id="kategoriaBackBtn" class="modal-secondary-btn">Vissza</button>
      </div>
    </div>
  </div>

  <div id="messageModal" class="modal hidden">
    <div class="modal-content">
      <button type="button" class="modal-close-btn" id="messageModalCloseBtn" aria-label="Bez√°r√°s">‚úï</button>
      <h3 id="messageModalTitle">Els≈ë kapcsolatfelv√©tel</h3>
      <textarea id="messageBody" rows="5" placeholder="√çrd ide az √ºzenetedet..."></textarea>
      <div class="modal-actions">
        <button id="cancelFirstMessageBtn" class="modal-secondary-btn">M√©gse</button>
        <button id="sendFirstMessageBtn" class="modal-primary-btn">K√ºld√©s</button>
      </div>
    </div>
  </div>

  <div id="reportManageModal" class="modal hidden">
    <div class="modal-content">
      <button type="button" class="modal-close-btn" id="reportManageModalCloseBtn" aria-label="Bez√°r√°s">‚úï</button>
      <h3>Hirdet√©sem r√©szletei</h3>
      <div id="reportManageDetails" class="report-manage-details"></div>
      <div class="manage-action-row">
        <button id="openManageActionsBtn" class="modal-primary-btn" type="button">Jelent√©s kezel√©se</button>
      </div>
      <div id="manageActionsPanel" class="hidden">
        <label for="manageReportTitleInput">C√≠m</label>
        <input id="manageReportTitleInput" type="text" placeholder="Pl. J√°rat: 7-es" />
        <label for="manageReportDescInput">Le√≠r√°s</label>
        <textarea id="manageReportDescInput" rows="4" maxlength="500" placeholder="Le√≠r√°s m√≥dos√≠t√°sa... (max. 500 karakter)"></textarea>
        <div class="modal-actions">
          <button id="saveManageChangesBtn" class="modal-primary-btn" type="button">M√≥dos√≠t√°s ment√©se</button>
          <button id="deleteReportBtn" class="danger-btn" type="button">T√∂rl√©s</button>
        </div>
      </div>
    </div>
  </div>

  <div id="imageViewerModal" class="modal hidden" aria-hidden="true">
    <div class="modal-content image-viewer-content">
      <button type="button" class="modal-close-btn" id="imageViewerCloseBtn" aria-label="Bez√°r√°s">‚úï</button>
      <h3>K√©p megtekint√©se</h3>
      <div class="image-stage-wrap">
        <button id="imagePrevBtn" class="modal-secondary-btn image-nav-btn" type="button" aria-label="El≈ëz≈ë k√©p">‚óÄ</button>
        <div class="image-stage" id="imageStage">
          <img id="imageViewerImg" src="" alt="Bejelent√©s k√©pe" />
        </div>
        <button id="imageNextBtn" class="modal-secondary-btn image-nav-btn" type="button" aria-label="K√∂vetkez≈ë k√©p">‚ñ∂</button>
      </div>
      <p id="imageCounter" class="image-counter"></p>
      <p class="image-viewer-help">Nagy√≠t√°s: eg√©rg√∂rg≈ëvel vagy k√©t ujjal. Mozgat√°s: h√∫zd az egeret / ujjad.</p>
    </div>
  </div>

  <div id="reportDetailModal" class="modal hidden" aria-hidden="true">
    <div class="modal-content report-detail-modal-content">
      <div id="reportDetailBody"></div>
      <div class="modal-actions single-action">
        <button type="button" class="modal-secondary-btn" id="reportDetailCloseBtn">Bez√°r</button>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="script.js"></script>
</body>
</html>
